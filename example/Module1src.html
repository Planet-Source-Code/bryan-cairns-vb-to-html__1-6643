<HTML><TITLE>Source Code</TITLE><BODY><FONT COLOR="#007F00">'VB Parseing and Documenting procedures</FONT><br><FONT COLOR="#007F00">'Create a new module for C++ Delphi or any other language</FONT><br><br><FONT COLOR="#007F00">'project globals</FONT><br><FONT COLOR="#00007F">Global</FONT> ProjectName <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> ProjectVersion <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> sLastFile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> Prodir <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> ProType <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> ProMinVer <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> DocDir <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#007F00">'3 colors from the RTF File Color Table</FONT><br><FONT COLOR="#00007F">Global</FONT> Hexx1 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> Hexx2 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Global</FONT> Hexx3 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> OpenTextFile(sfile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">GoTo</FONT> EH<br><FONT COLOR="#00007F">Dim</FONT> TMPTXT <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Dim</FONT> FinTxt <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Dim</FONT> IFile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br>IFile = FreeFile<br><FONT COLOR="#00007F">Open</FONT> sfile <FONT COLOR="#00007F">For</FONT> <FONT COLOR="#00007F">Binary</FONT> Access <FONT COLOR="#00007F">Read</FONT> <FONT COLOR="#00007F">As</FONT> #IFile<br>TMPTXT = Space$(LOF(IFile))<br><FONT COLOR="#00007F">Get</FONT> #IFile, , TMPTXT<br><FONT COLOR="#00007F">Close</FONT> #IFile<br>OpenTextFile = TMPTXT<br><FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>EH:<br>OpenTextFile = ""<br><FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> CheckFile(sfile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Boolean</FONT><br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">Resume</FONT> <FONT COLOR="#00007F">Next</FONT><br><FONT COLOR="#00007F">Dim</FONT> Iret<br>Iret = Dir(sfile)<br><FONT COLOR="#00007F">If</FONT> Iret &gt; "" <FONT COLOR="#00007F">Then</FONT><br>CheckFile = <FONT COLOR="#00007F">True</FONT><br><FONT COLOR="#00007F">Else</FONT><br><FONT COLOR="#00007F">If</FONT> Iret = "" <FONT COLOR="#00007F">Then</FONT><br>CheckFile = <FONT COLOR="#00007F">False</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> FileLines(sfile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> TextLine<br><FONT COLOR="#00007F">Dim</FONT> I <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br>I = 0<br><FONT COLOR="#00007F">Open</FONT> sfile <FONT COLOR="#00007F">For</FONT> <FONT COLOR="#00007F">Input</FONT> <FONT COLOR="#00007F">As</FONT> #1<br><FONT COLOR="#00007F">Do</FONT> <FONT COLOR="#00007F">While</FONT> <FONT COLOR="#00007F">Not</FONT> EOF(1)<br>   <FONT COLOR="#00007F">Line</FONT> <FONT COLOR="#00007F">Input</FONT> #1, TextLine<br>I = I + 1<br><FONT COLOR="#00007F">Loop</FONT><br><FONT COLOR="#00007F">Close</FONT> #1<br>FileLines = I<br><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> ParsePath(<FONT COLOR="#00007F">ByVal</FONT> TempPath <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>, ReturnType <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT>)<br><br>    <FONT COLOR="#00007F">Dim</FONT> DriveLetter <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> DirPath <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> fname <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> Extension <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> PathLength <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> ThisLength <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> Offset <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br>    <FONT COLOR="#00007F">Dim</FONT> FileNameFound <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Boolean</FONT><br><br>    <FONT COLOR="#00007F">If</FONT> ReturnType &lt;&gt; 0 <FONT COLOR="#00007F">And</FONT> ReturnType &lt;&gt; 1 <FONT COLOR="#00007F">And</FONT> ReturnType &lt;&gt; 2 <FONT COLOR="#00007F">And</FONT> ReturnType &lt;&gt; 3 <FONT COLOR="#00007F">Then</FONT><br>        Err.Raise 1<br>        <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>        DriveLetter = ""<br>        DirPath = ""<br>        fname = ""<br>        Extension = ""<br><br>        <FONT COLOR="#00007F">If</FONT> Mid(TempPath, 2, 1) = ":" <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#007F00">' Find the drive letter.</FONT><br>            DriveLetter = Left(TempPath, 2)<br>            TempPath = Mid(TempPath, 3)<br>        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>            PathLength = Len(TempPath)<br><br>            <FONT COLOR="#00007F">For</FONT> Offset = PathLength <FONT COLOR="#00007F">To</FONT> 1 Step -1 <FONT COLOR="#007F00">' Find the next delimiter.</FONT><br>                <FONT COLOR="#00007F">Select</FONT> <FONT COLOR="#00007F">Case</FONT> Mid(TempPath, Offset, 1)<br>                 <FONT COLOR="#00007F">Case</FONT> ".": <FONT COLOR="#007F00">' This indicates either an extension or a . or a ..</FONT><br>                 ThisLength = Len(TempPath) - Offset<br><br>                 <FONT COLOR="#00007F">If</FONT> ThisLength &gt;= 1 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#007F00">' Extension</FONT><br>                     Extension = Mid(TempPath, Offset, ThisLength + 1)<br>                 <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>                     TempPath = Left(TempPath, Offset - 1)<br>                     <FONT COLOR="#00007F">Case</FONT> "\": <FONT COLOR="#007F00">' This indicates a path delimiter.</FONT><br>                     ThisLength = Len(TempPath) - Offset<br><br>                     <FONT COLOR="#00007F">If</FONT> ThisLength &gt;= 1 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#007F00">' Filename</FONT><br>                         fname = Mid(TempPath, Offset + 1, ThisLength)<br>                         TempPath = Left(TempPath, Offset)<br>                         FileNameFound = <FONT COLOR="#00007F">True</FONT><br>                         <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">For</FONT><br>                     <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>                         <FONT COLOR="#00007F">Case</FONT> <FONT COLOR="#00007F">Else</FONT><br>                    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Select</FONT><br><br>                    <FONT COLOR="#00007F">Next</FONT> Offset<br><br><br>                        <FONT COLOR="#00007F">If</FONT> FileNameFound = <FONT COLOR="#00007F">False</FONT> <FONT COLOR="#00007F">Then</FONT><br>                            fname = TempPath<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            DirPath = TempPath<br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br><br>                            <FONT COLOR="#00007F">If</FONT> ReturnType = 0 <FONT COLOR="#00007F">Then</FONT><br>                                ParsePath = DriveLetter<br>                            <FONT COLOR="#00007F">ElseIf</FONT> ReturnType = 1 <FONT COLOR="#00007F">Then</FONT><br>                                ParsePath = DirPath<br>                            <FONT COLOR="#00007F">ElseIf</FONT> ReturnType = 2 <FONT COLOR="#00007F">Then</FONT><br>                                ParsePath = fname<br>                            <FONT COLOR="#00007F">ElseIf</FONT> ReturnType = 3 <FONT COLOR="#00007F">Then</FONT><br>                                ParsePath = Extension<br>                            <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Sub</FONT> CheckTMPDir(sDir <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>, dKill <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Boolean</FONT>)<br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">Resume</FONT> <FONT COLOR="#00007F">Next</FONT><br><FONT COLOR="#00007F">Dim</FONT> Iret<br>Iret = Dir(sDir, vbDirectory)<br><FONT COLOR="#00007F">If</FONT> Iret &gt; "" <FONT COLOR="#00007F">And</FONT> dKill = <FONT COLOR="#00007F">True</FONT> <FONT COLOR="#00007F">Then</FONT><br>RmTree sDir<br>MkDir sDir<br><FONT COLOR="#00007F">Else</FONT><br><FONT COLOR="#00007F">If</FONT> Iret = "" <FONT COLOR="#00007F">Then</FONT><br>MkDir sDir<br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Sub</FONT><br><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Sub</FONT> RmTree(<FONT COLOR="#00007F">ByVal</FONT> vDir <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Variant</FONT>)<br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">Resume</FONT> <FONT COLOR="#00007F">Next</FONT><br><FONT COLOR="#00007F">Dim</FONT> vFile <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Variant</FONT><br>    <FONT COLOR="#007F00">' Check if "\" was placed at end</FONT><br>    <FONT COLOR="#007F00">' If So, Remove it</FONT><br><FONT COLOR="#00007F">If</FONT> Right(vDir, 1) = "\" <FONT COLOR="#00007F">Then</FONT><br>        vDir = Left(vDir, Len(vDir) - 1)<br>    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><FONT COLOR="#007F00">' Check if Directory is Valid</FONT><br>    <FONT COLOR="#007F00">' If Not, Exit Sub</FONT><br>    vFile = Dir(vDir, vbDirectory)<br><FONT COLOR="#00007F">If</FONT> vFile = "" <FONT COLOR="#00007F">Then</FONT><br>        <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Sub</FONT><br>    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><FONT COLOR="#007F00">' Search For First File</FONT><br>    vFile = Dir(vDir & "\", vbDirectory)<br>    <FONT COLOR="#007F00">' Loop Until All Files and Directories</FONT><br>    <FONT COLOR="#007F00">' Have been Deleted</FONT><br><FONT COLOR="#00007F">Do</FONT> Until vFile = ""<br><br><br>        <FONT COLOR="#00007F">If</FONT> vFile = "." <FONT COLOR="#00007F">Or</FONT> vFile = ".." <FONT COLOR="#00007F">Then</FONT><br>            vFile = Dir<br>        <FONT COLOR="#00007F">ElseIf</FONT> (GetAttr(vDir & "\" & vFile) <FONT COLOR="#00007F">And</FONT> _<br>            vbDirectory) = vbDirectory <FONT COLOR="#00007F">Then</FONT><br>            RmTree vDir & "\" & vFile<br>            vFile = Dir(vDir & "\", vbDirectory)<br>        <FONT COLOR="#00007F">Else</FONT><br>            Kill vDir & "\" & vFile<br>            vFile = Dir<br>        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br><br>    <FONT COLOR="#00007F">Loop</FONT><br><br><br>    <FONT COLOR="#007F00">' Remove Top Most Directory</FONT><br>    RmDir vDir<br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Sub</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> Colorss(sLine <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>)<br><FONT COLOR="#00007F">Dim</FONT> S1, S2, S3, r, g, b <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Dim</FONT> sTMP <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Dim</FONT> ipos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> epos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> TTLine <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">Dim</FONT> Icount <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> Col1 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br><FONT COLOR="#00007F">Dim</FONT> Col2 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br><FONT COLOR="#00007F">Dim</FONT> Col3 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>Icount = 0<br>ipos = 0<br>epos = 1<br><FONT COLOR="#007F00">'The Color Table will look like:</FONT><br><FONT COLOR="#007F00">'{\colortbl\red0\green0\blue0;\red0\green0\blue128;\red0\green128\blue0;}</FONT><br><FONT COLOR="#007F00">'Add and Parse Hex# variables to get more colors</FONT><br><FONT COLOR="#007F00">'from the RTF file color table</FONT><br><FONT COLOR="#007F00">'I limited this to 3 colors</FONT><br><br>sTMP = Mid(sLine, 11, Len(sLine))<br><FONT COLOR="#007F00">'\red0\green0\blue0;\red0\green0\blue128;\red0\green128\blue0;}</FONT><br><FONT COLOR="#007F00">'read the line</FONT><br>ipos = InStr(epos, sTMP, ";", vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> ipos = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>TTLine = Mid(sTMP, epos, ipos)<br>r = GetLinEle(TTLine, "\red", "\green")<br>g = GetLinEle(TTLine, "\green", "\blue")<br>b = GetLinEle(TTLine, "\blue", ";")<br>Col1 = RGB(Int(r), Int(g), Int(b))<br>Hexx1 = GETHex(Col1)<br>epos = ipos + 1<br><br>ipos = InStr(epos, sTMP, ";", vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> ipos = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>TTLine = Mid(sTMP, epos, ipos)<br>r = GetLinEle(TTLine, "\red", "\green")<br>g = GetLinEle(TTLine, "\green", "\blue")<br>b = GetLinEle(TTLine, "\blue", ";")<br>Col2 = RGB(Int(r), Int(g), Int(b))<br>Hexx2 = GETHex(Col2)<br>epos = ipos + 1<br><br>ipos = InStr(epos, sTMP, ";", vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> ipos = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>TTLine = Mid(sTMP, epos, ipos)<br>r = GetLinEle(TTLine, "\red", "\green")<br>g = GetLinEle(TTLine, "\green", "\blue")<br>b = GetLinEle(TTLine, "\blue", ";")<br>Col3 = RGB(Int(r), Int(g), Int(b))<br>Hexx3 = GETHex(Col3)<br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> GetLinEle(Origin <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>, Sep1 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>, Sep2 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#007F00">'Parses a Line of text</FONT><br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">GoTo</FONT> EH<br><FONT COLOR="#00007F">Dim</FONT> Bpos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br><FONT COLOR="#00007F">Dim</FONT> epos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>Bpos = InStr(1, Origin, Sep1, vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> Bpos = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>epos = InStr(1, Origin, Sep2, vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> Bpos = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>Bpos = Bpos + Len(Sep1)<br>GetLinEle = Mid(Origin, Bpos, epos - Bpos)<br><FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br>EH:<br>GetLinEle = ""<br><FONT COLOR="#00007F">Exit</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Public</FONT> <FONT COLOR="#00007F">Function</FONT> GETHex(stColor <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br><FONT COLOR="#00007F">On</FONT> <FONT COLOR="#00007F">Error</FONT> <FONT COLOR="#00007F">Resume</FONT> <FONT COLOR="#00007F">Next</FONT><br><FONT COLOR="#007F00">'stColor = m_CurHex</FONT><br>       <FONT COLOR="#007F00">'     'If r &gt; 255 Then Exit Sub</FONT><br>       <FONT COLOR="#007F00">'     'If g &gt; 255 Then Exit Sub</FONT><br>       <FONT COLOR="#007F00">'     'If b &gt; 255 Then Exit Sub</FONT><br>       <FONT COLOR="#00007F">Dim</FONT> r, b, g <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>       <br>       <FONT COLOR="#00007F">Dim</FONT> dts <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Variant</FONT><br>       <FONT COLOR="#00007F">Dim</FONT> q, w, e <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Variant</FONT><br>       <FONT COLOR="#00007F">Dim</FONT> qw, we, gq <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Variant</FONT><br>       <FONT COLOR="#00007F">Dim</FONT> lCol <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>       lCol = stColor<br>       r = lCol Mod &H100<br>       lCol = lCol \ &H100<br>       g = lCol Mod &H100<br>       lCol = lCol \ &H100<br>       b = lCol Mod &H100<br>       <br>       <FONT COLOR="#007F00">'     'Get Red Hex</FONT><br>       q = Hex(r)<br><br>              <FONT COLOR="#00007F">If</FONT> Len(q) &lt; 2 <FONT COLOR="#00007F">Then</FONT><br>                     qw = q<br>                     q = "0" & qw<br>              <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>       <FONT COLOR="#007F00">'     'Get Blue Hex</FONT><br>       w = Hex(b)<br><br>              <FONT COLOR="#00007F">If</FONT> Len(w) &lt; 2 <FONT COLOR="#00007F">Then</FONT><br>                     we = w<br>                     w = "0" & we<br>              <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>       <FONT COLOR="#007F00">'     'Get Green Hex</FONT><br>       e = Hex(g)<br><br>              <FONT COLOR="#00007F">If</FONT> Len(e) &lt; 2 <FONT COLOR="#00007F">Then</FONT><br>                     gq = e<br>                     e = "0" & gq<br>              <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><br>       <FONT COLOR="#007F00">'GETRGB = "#" & q & e & w</FONT><br>       GETHex = "#" & q & e & w   <FONT COLOR="#007F00">'"#" &</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br><FONT COLOR="#00007F">Function</FONT> RTF2HTML(strRTF <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT>) <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>    <FONT COLOR="#007F00">'Version 2.1 (3/30/99)</FONT><br>    <FONT COLOR="#007F00">'The most current version of this function is available at</FONT><br>    <FONT COLOR="#007F00">'http://www2.bitstream.net/~bradyh/downl</FONT><br>    <FONT COLOR="#007F00">'     oads/rtf2html.zip</FONT><br>    <FONT COLOR="#007F00">'Converts Rich Text encoded text to HTML</FONT><br><FONT COLOR="#00007F">Dim</FONT> ipos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> epos <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Integer</FONT><br><FONT COLOR="#00007F">Dim</FONT> ssColTBL <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>ipos = InStr(1, strRTF, "{\colortbl", vbBinaryCompare)<br>epos = InStr(ipos + 1, strRTF, "}", vbBinaryCompare)<br><FONT COLOR="#00007F">If</FONT> ipos &lt;&gt; 0 <FONT COLOR="#00007F">And</FONT> epos &lt;&gt; 0 <FONT COLOR="#00007F">Then</FONT><br><br>ssColTBL = Mid(strRTF, ipos, epos - ipos)<br>Colorss ssColTBL<br><FONT COLOR="#00007F">Else</FONT><br><FONT COLOR="#00007F">If</FONT> ipos = 0 <FONT COLOR="#00007F">Or</FONT> epos = 0 <FONT COLOR="#00007F">Then</FONT><br>Hexx1 = "#000000"<br>Hexx2 = "#000000"<br>Hexx3 = "#000000"<br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>    <FONT COLOR="#007F00">'     format</FONT><br>        <FONT COLOR="#007F00">'if you find some text that this function doesn't</FONT><br>        <FONT COLOR="#007F00">'convert properly please email the text</FONT><br>        <FONT COLOR="#007F00">'     to</FONT><br>        <FONT COLOR="#007F00">'bradyh@bitstream.net</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> strHTML <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> l <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> lTmp <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> lRTFLen <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> lBOS <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT> <FONT COLOR="#007F00">'beginning of section</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> lEOS <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Long</FONT> <FONT COLOR="#007F00">'end of section</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> strTmp <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> strTmp2 <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> strEOS <FONT COLOR="#007F00">'string To be added to End of section</FONT><br>        <FONT COLOR="#00007F">Const</FONT> gHellFrozenOver = <FONT COLOR="#00007F">False</FONT> <FONT COLOR="#007F00">'always false</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> gSkip <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Boolean</FONT> <FONT COLOR="#007F00">'skip To Next word/command</FONT><br>        <FONT COLOR="#00007F">Dim</FONT> strCodes <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT> <FONT COLOR="#007F00">'codes For ascii To HTML char conversion</FONT><br>        strCodes = "  {00}{00}© {a9}© {a9}´ {b4}´ {b4}« {ab}« {ab}» {bb}» {bb}¡ {a1}}¡ {a1}¿{bf}1}¿{bf}À{c0}f}À{c0}à{e0}0}à{e0}Á{c1}"<br>        strCodes = strCodes & "0}Á{c1}á{e1}}á{e1}Â {c2}Â {c2}â {e2}}â {e2}Ã{c3}2}Ã{c3}ã{e3}}ã{e3}Ä {c4}Ä {c4}ä {e4}ä {e4}Å {c5}Å {c5}å {e5}å {e5}Æ {c6}"<br>        strCodes = strCodes & "Æ {c6}æ {e6}}æ {e6}Ç{c7}6}Ç{c7}ç{e7}7}ç{e7}Ð{d0}7}Ð{d0}ð{f0}0}ð{f0}È{c8}0}È{c8}è{e8}8}è{e8}É{c9}8}É{c9}é{e9}}é{e9}Ê {ca}"<br>        strCodes = strCodes & "Ê {ca}ê {ea}ê {ea}Ë {cb}Ë {cb}ë {eb}}ë {eb}Ì{cc}b}Ì{cc}ì{ec}c}ì{ec}Í{cd}c}Í{cd}í{ed}}í{ed}Î {ce}Î {ce}î {ee}î {ee}Ï {cf}"<br>        strCodes = strCodes & "Ï {cf}ï {ef}}ï {ef}Ñ{d1}f}Ñ{d1}ñ{f1}1}ñ{f1}Ò{d2}1}Ò{d2}ò{f2}2}ò{f2}Ó{d3}2}Ó{d3}ó{f3}}ó{f3}Ô {d4}Ô {d4}ô {f4}}ô {f4}Õ{d5}"<br>        strCodes = strCodes & "4}Õ{d5}õ{f5}}õ{f5}Ö {d6}Ö {d6}ö {f6}}ö {f6}Ø{d8}6}Ø{d8}ø{f8}8}ø{f8}Ù{d9}8}Ù{d9}ù{f9}9}ù{f9}Ú{da}9}Ú{da}ú{fa}}ú{fa}Û {db}"<br>        strCodes = strCodes & "Û {db}û {fb}û {fb}Ü {dc}Ü {dc}ü {fc}}ü {fc}Ý{dd}c}Ý{dd}ý{fd}}ý{fd}ÿ {ff}ÿ {ff}Þ {de}Þ {de}þ {fe}þ {fe}ß {df}ß {df}§ {a7}"<br>        strCodes = strCodes & "§ {a7}¶ {b6}¶ {b6}µ {b5}}µ {b5}¦{a6}5}¦{a6}±{b1}6}±{b1}·{b7}1}·{b7}¨{a8}}¨{a8}¸ {b8}¸ {b8}ª {aa}ª {aa}º {ba}}º {ba}¬{ac}"<br>        strCodes = strCodes & "a}¬{ac}­{ad}}­{ad}¯ {af}}¯ {af}°{b0}}°{b0}¹ {b9}¹ {b9}² {b2}² {b2}³ {b3}}³ {b3}¼{bc}3}¼{bc}½{bd}c}½{bd}¾{be}}¾{be}× {d7}"<br>        strCodes = strCodes & "}× {d7}÷{f7}}÷{f7}¢ {a2}¢ {a2}£ {a3}}£ {a3}¤{a4}3}¤{a4}¥{a5}"<br>        strHTML = ""<br>        lRTFLen = Len(strRTF)<br>        <FONT COLOR="#007F00">'seek first line with text on it</FONT><br>        lBOS = InStr(strRTF, vbCrLf & "\deflang")<br>        <FONT COLOR="#00007F">If</FONT> lBOS = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">GoTo</FONT> finally <FONT COLOR="#00007F">Else</FONT> lBOS = lBOS + 2<br>        lEOS = InStr(lBOS, strRTF, vbCrLf & "\par")<br>        <FONT COLOR="#00007F">If</FONT> lEOS = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">GoTo</FONT> finally<br><br><br>        <FONT COLOR="#00007F">While</FONT> <FONT COLOR="#00007F">Not</FONT> gHellFrozenOver<br>            strTmp = Mid(strRTF, lBOS, lEOS - lBOS)<br>            l = lBOS<br><br><br>            <FONT COLOR="#00007F">While</FONT> l &lt;= lEOS<br>                strTmp = Mid(strRTF, l, 1)<br><br>                <FONT COLOR="#00007F">Select</FONT> <FONT COLOR="#00007F">Case</FONT> strTmp<br>                    <FONT COLOR="#00007F">Case</FONT> "&lt;"<br>                    strHTML = strHTML & "&lt;"<br>                    l = l + 1<br>                    <FONT COLOR="#00007F">Case</FONT> "&gt;"<br>                   strHTML = strHTML & "&gt;"<br>                   l = l + 1<br>                    <FONT COLOR="#00007F">Case</FONT> "{"<br>                    l = l + 1<br>                    <FONT COLOR="#00007F">Case</FONT> "}"<br>                    strHTML = strHTML & strEOS<br>                    l = l + 1<br>                    <FONT COLOR="#00007F">Case</FONT> "\" <FONT COLOR="#007F00">'special code</FONT><br>                    l = l + 1<br>                    strTmp = Mid(strRTF, l, 1)<br>                    <FONT COLOR="#007F00">'//////////////////////</FONT><br>                    <FONT COLOR="#007F00">'Below is my modification</FONT><br>                    <FONT COLOR="#007F00">'to get the colors form the RTF</FONT><br>                    <FONT COLOR="#007F00">'color table</FONT><br>                    <FONT COLOR="#007F00">'colors are \cf#  the # is the color table</FONT><br>                    <FONT COLOR="#007F00">'colors are as follows</FONT><br>                    <FONT COLOR="#007F00">'cf0 = &h0 //black - #000000</FONT><br>                    <FONT COLOR="#007F00">'cf1 = &H00800000& //blue - keyword #000080</FONT><br>                    <FONT COLOR="#007F00">'cf2 =  &H00008000& //green - comment #008000</FONT><br>                    <FONT COLOR="#007F00">'</FONT><br>                    <FONT COLOR="#007F00">'</FONT><br>                    <FONT COLOR="#00007F">Dim</FONT> bcColor <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">String</FONT><br>                    <FONT COLOR="#00007F">Dim</FONT> CCOlON <FONT COLOR="#00007F">As</FONT> <FONT COLOR="#00007F">Boolean</FONT><br>                    <br>                    bcColor = Mid(strRTF, l, 3)<br>                   <br>                    <FONT COLOR="#00007F">If</FONT> bcColor = "pla" <FONT COLOR="#00007F">And</FONT> CCOlON = <FONT COLOR="#00007F">True</FONT> <FONT COLOR="#00007F">Then</FONT><br>                        strHTML = strHTML & "&lt;/FONT&gt;"<br>                        CCOlON = <FONT COLOR="#00007F">False</FONT><br>                    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                    <FONT COLOR="#00007F">If</FONT> bcColor = "cf1" <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#007F00">'color1 - keywords</FONT><br>                        strHTML = strHTML & "&lt;FONT COLOR=""" & Hexx2 & """&gt;"<br>                        CCOlON = <FONT COLOR="#00007F">True</FONT><br>                    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                    <FONT COLOR="#00007F">If</FONT> bcColor = "cf2" <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#007F00">'color2 - comments</FONT><br>                        strHTML = strHTML & "&lt;FONT COLOR=""" & Hexx3 & """&gt;"<br>                        CCOlON = <FONT COLOR="#00007F">True</FONT><br>                    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                    <FONT COLOR="#007F00">'/////////////////////////////</FONT><br>                    <FONT COLOR="#00007F">Select</FONT> <FONT COLOR="#00007F">Case</FONT> strTmp<br>                        <FONT COLOR="#00007F">Case</FONT> "b"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> ((Mid(strRTF, l + 1, 1) = " ") <FONT COLOR="#00007F">Or</FONT> (Mid(strRTF, l + 1, 1) = "\")) <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "&lt;B&gt;"<br>                            strEOS = "&lt;/B&gt;" & strEOS<br>                            <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l + 1, 1) = " ") <FONT COLOR="#00007F">Then</FONT> l = l + 1<br>                        <FONT COLOR="#00007F">ElseIf</FONT> (Mid(strRTF, l, 7) = "bullet ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "•" <FONT COLOR="#007F00">'bullet</FONT><br>                            l = l + 6<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "e"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l, 7) = "emdash ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "—"<br>                            l = l + 6<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "i"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> ((Mid(strRTF, l + 1, 1) = " ") <FONT COLOR="#00007F">Or</FONT> (Mid(strRTF, l + 1, 1) = "\")) <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "&lt;I&gt;"<br>                            strEOS = "&lt;/I&gt;" & strEOS<br>                            <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l + 1, 1) = " ") <FONT COLOR="#00007F">Then</FONT> l = l + 1<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "l"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l, 10) = "ldblquote ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "“"<br>                            l = l + 9<br>                        <FONT COLOR="#00007F">ElseIf</FONT> (Mid(strRTF, l, 7) = "lquote ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "‘"<br>                            l = l + 6<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "p"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> ((Mid(strRTF, l, 6) = "plain\") <FONT COLOR="#00007F">Or</FONT> (Mid(strRTF, l, 6) = "plain ")) <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & strEOS<br>                            strEOS = ""<br>                            <FONT COLOR="#00007F">If</FONT> Mid(strRTF, l + 5, 1) = "\" <FONT COLOR="#00007F">Then</FONT> l = l + 4 <FONT COLOR="#00007F">Else</FONT> l = l + 5 <FONT COLOR="#007F00">'catch Next \ but skip a space</FONT><br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "r"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l, 7) = "rquote ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "’"<br>                            l = l + 6<br>                        <FONT COLOR="#00007F">ElseIf</FONT> (Mid(strRTF, l, 10) = "rdblquote ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & "”"<br>                            l = l + 9<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "t"<br><br><br>                        <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l, 4) = "tab ") <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & Chr$(9) <FONT COLOR="#007F00">'tab</FONT><br>                            l = l + 3<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            gSkip = <FONT COLOR="#00007F">True</FONT><br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        <FONT COLOR="#00007F">Case</FONT> "'"<br>                        strTmp2 = "{" & Mid(strRTF, l + 1, 2) & "}"<br>                        lTmp = InStr(strCodes, strTmp2)<br><br><br>                        <FONT COLOR="#00007F">If</FONT> lTmp = 0 <FONT COLOR="#00007F">Then</FONT><br>                            strHTML = strHTML & Chr("&H" & Mid(strTmp2, 2, 2))<br>                        <FONT COLOR="#00007F">Else</FONT><br>                            strHTML = strHTML & Trim(Mid(strCodes, lTmp - 8, 8))<br>                        <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                        l = l + 2<br>                        <FONT COLOR="#00007F">Case</FONT> "~"<br>                        strHTML = strHTML & " "<br>                        <FONT COLOR="#00007F">Case</FONT> "{", "}", "\"<br>                        strHTML = strHTML & strTmp<br>                        <FONT COLOR="#00007F">Case</FONT> vbLf, vbCr, vbCrLf <FONT COLOR="#007F00">'always use vbCrLf</FONT><br>                        strHTML = strHTML & vbCrLf<br>                        <FONT COLOR="#00007F">Case</FONT> <FONT COLOR="#00007F">Else</FONT><br>                        gSkip = <FONT COLOR="#00007F">True</FONT><br>                    <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Select</FONT><br><br><br>                <FONT COLOR="#00007F">If</FONT> gSkip = <FONT COLOR="#00007F">True</FONT> <FONT COLOR="#00007F">Then</FONT><br>                    <FONT COLOR="#007F00">'skip everything up until the next space</FONT><br>                    <FONT COLOR="#007F00">'     or "\"</FONT><br><br><br>                    <FONT COLOR="#00007F">While</FONT> ((Mid(strRTF, l, 1) &lt;&gt; " ") <FONT COLOR="#00007F">And</FONT> (Mid(strRTF, l, 1) &lt;&gt; "\"))<br>                        l = l + 1<br>                    <FONT COLOR="#00007F">Wend</FONT><br>                    gSkip = <FONT COLOR="#00007F">False</FONT><br>                    <FONT COLOR="#00007F">If</FONT> (Mid(strRTF, l, 1) = "\") <FONT COLOR="#00007F">Then</FONT> l = l - 1<br>                <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">If</FONT><br>                l = l + 1<br>                <FONT COLOR="#00007F">Case</FONT> vbLf, vbCr, vbCrLf<br>                l = l + 1<br>                <FONT COLOR="#00007F">Case</FONT> <FONT COLOR="#00007F">Else</FONT><br>                strHTML = strHTML & strTmp<br>                l = l + 1<br>            <FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Select</FONT><br>    <FONT COLOR="#00007F">Wend</FONT><br>    lBOS = lEOS + 2<br>    lEOS = InStr(lEOS + 1, strRTF, vbCrLf & "\par")<br>    <FONT COLOR="#00007F">If</FONT> lEOS = 0 <FONT COLOR="#00007F">Then</FONT> <FONT COLOR="#00007F">GoTo</FONT> finally<br>    strHTML = strHTML & "&lt;br&gt;"<br><FONT COLOR="#00007F">Wend</FONT><br>finally:<br>RTF2HTML = strHTML<br><FONT COLOR="#00007F">End</FONT> <FONT COLOR="#00007F">Function</FONT><br></BODY></HTML>
